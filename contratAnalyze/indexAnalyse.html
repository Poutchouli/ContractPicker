<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport d'Aide √† la D√©cision - Analyse des Offres de Contrat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-100 text-gray-800">
    <!-- API Key Button and Modal -->
    <button id="openApiModalBtn" class="fixed top-6 right-8 z-50 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md flex items-center gap-2">
        <span>üîë API Gemini</span>
    </button>
    <div id="apiModal" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg p-8 w-full max-w-md relative">
            <button id="closeApiModalBtn" class="absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
            <h2 class="text-xl font-bold mb-4 text-gray-800">Configurer la cl√© API Gemini</h2>
            <input id="modalApiKeyInput" type="text" placeholder="Cl√© API Gemini" class="border rounded px-3 py-2 w-full mb-4" />
            <div class="flex gap-3"></div>
            <div id="testApiKeyResult" class="mt-3 text-sm"></div>
        </div>
    </div>

    <div id="uploadPage" class="container mx-auto p-4 md:p-8">
        <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-lg p-8">
            <h1 class="text-3xl font-bold text-center mb-4 text-gray-800">Analyseur d'Offres de Contrat</h1>
            <p class="text-center text-gray-600 mb-8">Importez votre fichier CSV export√© depuis l'outil de saisie pour g√©n√©rer un rapport d'aide √† la d√©cision destin√© √† la direction. Le fichier doit suivre le format d'export de l'outil.</p>
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6 text-center">
                <input type="file" id="csvFileInput" accept=".csv" class="mb-2" />
                <div id="fileName" class="text-sm text-gray-500"></div>
            </div>
        </div>
    </div>

    <div id="reportPage" class="hidden container mx-auto p-4 md:p-8">
        <button id="backButton" class="mb-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">
            &larr; Retour √† l'import
        </button>
        <h1 class="text-4xl font-bold text-center mb-8 text-gray-800">Rapport d'Aide √† la D√©cision - Analyse des Offres de Contrat</h1>

        <!-- Executive Summary -->
        <section id="executiveSummary" class="executive-section">
            <h2 class="section-title">R√©sum√© Ex√©cutif</h2>
            <div id="executiveSummaryContent" class="caption"></div>
        </section>

        <!-- Summary Table -->
        <section id="summaryTableSection" class="executive-section">
            <h2 class="section-title">Tableau comparatif des offres</h2>
            <div class="caption">Comparaison synth√©tique des principales caract√©ristiques de chaque offre.</div>
            <div id="summaryTableContainer"></div>
        </section>

        <!-- Charts Section -->
        <section id="chartsSection" class="executive-section">
            <h2 class="section-title">Visualisations cl√©s</h2>
            <div class="caption">Graphiques pour une vision globale et rapide des co√ªts et crit√®res.</div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8" id="chartsGrid">
                <div id="priceComparisonSection"></div>
                <div id="featureComparisonSection"></div>
                <div id="pieChartSection"></div>
                <div id="lineChartSection"></div>
            </div>
        </section>

        <!-- Decision Points -->
        <section id="decisionPointsSection" class="executive-section">
            <h2 class="section-title">Points cl√©s pour la d√©cision</h2>
            <div id="decisionPointsContent"></div>
        </section>

        <!-- Section IA (optionnel) -->
        <div id="aiInsightsSection" class="executive-section"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>
